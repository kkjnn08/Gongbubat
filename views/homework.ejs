<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>숙제</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">
</head>
    <style>
        /* body{
            width: 1130px;
            margin: 0 auto;
        } */

    </style>
<body>
    <!-- nav bar -->
    <%- include('nav.html') %>

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>

    <h3 class="text-center mt-4 mb-4" id="viewTitle">숙제 관리</h3>
    <!-- <form action="/add" method="post"> -->
        <div class="container form-group text-center" id="input-hw-form">
        <!-- <div class="text-center"> -->
            <div class="mb-2 row col-md-10 col-lg-8 mx-auto border border-1 rounded-3 pt-2">
                <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                </div>
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <button class="btn btn-primary btn-sm mb-2" type="button" id="btn-update">완료</button>
                </div>
                <% homeworks.forEach(hw=>{ %>
                    <label for="text" class="col-md-1 col-form-label my-auto"><%=hw.date.d%></label>
                    <div class="col-sm-11">
                    <input type="text" class="form-control col-md-11 form-control-sm" id="<%=hw.date.d%>" value="<%=hw.content%>">
                    </div>
                <% }) %>
            </div>
            <!-- <button class="btn btn-primary btn-sm" type="button" id="btn-update">완료</button> -->
        </div>
    <!-- </form> -->
    <script>
        //월
        const date = new Date()
        const viewYear = date.getFullYear()
        const viewMonth = date.getMonth()+1

        $('#viewTitle').text(`${viewMonth}월 숙제 관리`)
        
        console.log()
        $('#btn-update').click((e)=>{
            let inputValues={}
            // let inputValues=[]

            //{input tag id : input value}
            $('input').each((index, item)=>{
                // console.log(item.id +', '+item.value)
                inputValues[item.id] = item.value
                // inputValues.push(item.value)
            })
            console.log(inputValues)

            $.ajax({
                method: 'PUT',
                url : '/homework',
                data : inputValues
            }).done((result)=>{
                //update 성공
                console.log(result)
            }).fail((xhr, textStatus, errorThrown)=>{
            //update 실패
            console.log('homework collection update failed...', xhr, textStatus, errorThrown)
            })
        })

    </script>

</body>
</html>